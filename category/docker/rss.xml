<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>SOHOPHP • Posts by &#34;docker&#34; category</title>
        <link>https://www.sohophp.app</link>
        <description></description>
        <language>en</language>
        <pubDate>Wed, 03 Mar 2021 12:53:57 +0000</pubDate>
        <lastBuildDate>Wed, 03 Mar 2021 12:53:57 +0000</lastBuildDate>
        <category>Composer</category>
        <category>PHP</category>
        <category>CRM</category>
        <category>CentOS</category>
        <category>CentOS7</category>
        <category>SSL</category>
        <category>Apache</category>
        <category>Https</category>
        <category>Linux</category>
        <category>Centos</category>
        <category>ModSecurity</category>
        <category>CRS</category>
        <category>Httpd</category>
        <category>SELinux</category>
        <category>Visual Sudio Code</category>
        <category>docker</category>
        <category>Docker</category>
        <category>Hexo</category>
        <category>Markdown</category>
        <category>php</category>
        <category>ubuntu</category>
        <category>linux</category>
        <category>PHP7</category>
        <category>PHP7.2</category>
        <category>MySQL</category>
        <category>MariaDB</category>
        <category>PHP-FPM</category>
        <item>
            <guid isPermalink="true">https://www.sohophp.app/2021/03/03/docker/</guid>
            <title>docker</title>
            <link>https://www.sohophp.app/2021/03/03/docker/</link>
            <category>Docker</category>
            <pubDate>Wed, 03 Mar 2021 12:53:57 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;mysql容器使用固定IP方法&#34;&gt;&lt;a href=&#34;#mysql容器使用固定IP方法&#34; class=&#34;headerlink&#34; title=&#34;mysql容器使用固定IP方法&#34;&gt;&lt;/a&gt;mysql容器使用固定IP方法&lt;/h2&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 创建自定网络&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;docker network create --subnet=172.18.0.0/16 mynetwork&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 指定使用的网络和ip运行mysql&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;docker run -p 33306:3306 --name mysql -v /home/jason/var/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=xxxxxx --net mynetwork --ip 172.18.0.136 -d mysql:5.6 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;docker run --name php -v /home/jason/webroot:/var/www/html --net mynetwork --ip 172.18.0.80 -itd sohophp/php-multi-apache:latest start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.sohophp.app/2021/02/27/docker-%E5%87%8F%E5%B0%8F%E4%BD%93%E7%A7%AF%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84%E9%95%9C%E5%83%8F/</guid>
            <title>docker 减小体积生成新的镜像</title>
            <link>https://www.sohophp.app/2021/02/27/docker-%E5%87%8F%E5%B0%8F%E4%BD%93%E7%A7%AF%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84%E9%95%9C%E5%83%8F/</link>
            <category>docker</category>
            <pubDate>Sat, 27 Feb 2021 14:46:52 +0000</pubDate>
            <description><![CDATA[ &lt;p&gt;Docker commit 每次都会加大镜像体积&lt;/p&gt;
&lt;p&gt;解决办法:&lt;/p&gt;
&lt;p&gt;使用Docker import 导入系统文件,丢弃镜像历史引用.&lt;/p&gt;
&lt;p&gt;同样适用于全新安装系统生成docker镜像。&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 查看容器id, &amp;#123;container_id&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ docker ps&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 开启一个&amp;#123;container_id&amp;#125;的交互式终端&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ docker &lt;span class=&#34;built_in&#34;&gt;exec&lt;/span&gt; -it &amp;#123;container_id&amp;#125; bash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;cd&lt;/span&gt; /&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 清理,同时可以删除和清理其它&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ yum clean all &amp;amp;&amp;amp; &lt;span class=&#34;built_in&#34;&gt;history&lt;/span&gt; -cw&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 查看/目录文件大小&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ du -h --exclude=/proc --exclude=/sys /&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 压缩成base.tar 排除/proc和/sys&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 在使用--exclude=/proc时会出错，所以使用 &amp;gt;/dev/null 可以看到错误消息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ tar --exclude=/proc --exclude=/sys --exclude=/base.tar -cvf base.tar / &amp;gt;/dev/null&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 退出容器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;exit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 复制容器&amp;#123;ontainer_id&amp;#125;中的/base.tar文件到当前目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ docker cp &amp;#123;container_id&amp;#125;:/base.tar .&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 使用base.tar 生成&amp;#123;image_name&amp;#125; 镜像&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ cat base.tar | docker import - &amp;#123;image_name&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 查看生成的镜像 (1.28G 转换后501Mb )&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ docker image ls&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
    </channel>
</rss>
