{
    "version": "https://jsonfeed.org/version/1",
    "title": "SOHOPHP • All posts by \"docker\" tag",
    "description": "",
    "home_page_url": "https://www.sohophp.app",
    "items": [
        {
            "id": "https://www.sohophp.app/2021/03/03/docker/",
            "url": "https://www.sohophp.app/2021/03/03/docker/",
            "title": "docker",
            "date_published": "2021-03-03T12:53:57.000Z",
            "content_html": "<h2 id=\"mysql容器使用固定IP方法\"><a href=\"#mysql容器使用固定IP方法\" class=\"headerlink\" title=\"mysql容器使用固定IP方法\"></a>mysql容器使用固定IP方法</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 创建自定网络</span></span><br><span class=\"line\">docker network create --subnet=172.18.0.0/16 mynetwork</span><br><span class=\"line\"><span class=\"comment\"># 指定使用的网络和ip运行mysql</span></span><br><span class=\"line\">docker run -p 33306:3306 --name mysql -v /home/jason/var/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=xxxxxx --net mynetwork --ip 172.18.0.136 -d mysql:5.6 </span><br><span class=\"line\">docker run --name php -v /home/jason/webroot:/var/www/html --net mynetwork --ip 172.18.0.80 -itd sohophp/php-multi-apache:latest start</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "Docker"
            ]
        },
        {
            "id": "https://www.sohophp.app/2021/02/27/docker-%E5%87%8F%E5%B0%8F%E4%BD%93%E7%A7%AF%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84%E9%95%9C%E5%83%8F/",
            "url": "https://www.sohophp.app/2021/02/27/docker-%E5%87%8F%E5%B0%8F%E4%BD%93%E7%A7%AF%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84%E9%95%9C%E5%83%8F/",
            "title": "docker 减小体积生成新的镜像",
            "date_published": "2021-02-27T14:46:52.000Z",
            "content_html": "<p>Docker commit 每次都会加大镜像体积</p>\n<p>解决办法:</p>\n<p>使用Docker import 导入系统文件,丢弃镜像历史引用.</p>\n<p>同样适用于全新安装系统生成docker镜像。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看容器id, &#123;container_id&#125;</span></span><br><span class=\"line\">$ docker ps</span><br><span class=\"line\"><span class=\"comment\"># 开启一个&#123;container_id&#125;的交互式终端</span></span><br><span class=\"line\">$ docker <span class=\"built_in\">exec</span> -it &#123;container_id&#125; bash</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> /</span><br><span class=\"line\"><span class=\"comment\"># 清理,同时可以删除和清理其它</span></span><br><span class=\"line\">$ yum clean all &amp;&amp; <span class=\"built_in\">history</span> -cw</span><br><span class=\"line\"><span class=\"comment\"># 查看/目录文件大小</span></span><br><span class=\"line\">$ <span class=\"built_in\">du</span> -h --exclude=/proc --exclude=/sys /</span><br><span class=\"line\"><span class=\"comment\"># 压缩成base.tar 排除/proc和/sys</span></span><br><span class=\"line\"><span class=\"comment\"># 在使用--exclude=/proc时会出错，所以使用 &gt;/dev/null 可以看到错误消息</span></span><br><span class=\"line\">$ tar --exclude=/proc --exclude=/sys --exclude=/base.tar -cvf base.tar / &gt;/dev/null</span><br><span class=\"line\"><span class=\"comment\"># 退出容器</span></span><br><span class=\"line\">$ <span class=\"built_in\">exit</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 复制容器&#123;ontainer_id&#125;中的/base.tar文件到当前目录</span></span><br><span class=\"line\">$ docker <span class=\"built_in\">cp</span> &#123;container_id&#125;:/base.tar .</span><br><span class=\"line\"><span class=\"comment\"># 使用base.tar 生成&#123;image_name&#125; 镜像</span></span><br><span class=\"line\">$ <span class=\"built_in\">cat</span> base.tar | docker import - &#123;image_name&#125;</span><br><span class=\"line\"><span class=\"comment\"># 查看生成的镜像 (1.28G 转换后501Mb )</span></span><br><span class=\"line\">$ docker image <span class=\"built_in\">ls</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "docker"
            ]
        }
    ]
}