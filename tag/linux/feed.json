{
    "version": "https://jsonfeed.org/version/1",
    "title": "SOHOPHP • All posts by \"linux\" tag",
    "description": "",
    "home_page_url": "https://www.sohophp.app",
    "items": [
        {
            "id": "https://www.sohophp.app/2021/05/03/ubuntu20-install-php7-2/",
            "url": "https://www.sohophp.app/2021/05/03/ubuntu20-install-php7-2/",
            "title": "ubuntu20 install php7.2",
            "date_published": "2021-05-03T11:15:00.000Z",
            "content_html": "<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># update and upgrade</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ sudo apt update &amp;&amp; apt upgrade</span><br><span class=\"line\"><span class=\"comment\"># install software-properties-common</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ sudo apt-get install software-properties-common</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># add apt repository ppa:ondrej/php</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ sudo add-apt-repository ppa:ondrej/php</span><br><span class=\"line\"><span class=\"comment\"># install php7.2 and extensions</span></span><br><span class=\"line\"><span class=\"comment\"># optional: libapache2-mod-php7.2 </span></span><br><span class=\"line\"><span class=\"comment\"># optional: php7.2-xdebug  </span></span><br><span class=\"line\">$ sudo apt install php7.2 \\</span><br><span class=\"line\">php7.2-cli \\</span><br><span class=\"line\">php7.2-common \\</span><br><span class=\"line\">php7.2-curl \\</span><br><span class=\"line\">php7.2-fpm \\</span><br><span class=\"line\">php7.2-gd \\</span><br><span class=\"line\">php7.2-json \\</span><br><span class=\"line\">php7.2-mbstring \\</span><br><span class=\"line\">php7.2-mcrypt \\</span><br><span class=\"line\">php7.2-mysql  \\</span><br><span class=\"line\">php7.2-opcache \\</span><br><span class=\"line\">php7.2-sqlite3 \\</span><br><span class=\"line\">php7.2-yaml \\</span><br><span class=\"line\">php7.2-zip \\</span><br><span class=\"line\">php7.2-dom</span><br><span class=\"line\"><span class=\"comment\"># enable startup php7.2-fpm</span></span><br><span class=\"line\">$ sudo systemctl <span class=\"built_in\">enable</span> php7.2-fpm</span><br><span class=\"line\"><span class=\"comment\"># start php7.2-fpm</span></span><br><span class=\"line\">$ sudo systemctl start php7.2-fpm</span><br><span class=\"line\">$ sudo systemctl status php7.2-fpm</span><br><span class=\"line\">$ sudo a2enmod proxy_fcgi setenvif</span><br><span class=\"line\"><span class=\"comment\"># enable rewrite</span></span><br><span class=\"line\">$ sudo a2emod <span class=\"built_in\">enable</span> rewrite</span><br><span class=\"line\"><span class=\"comment\"># enable php7.2-fpm</span></span><br><span class=\"line\">$ sudo a2enconf php7.2-fpm</span><br><span class=\"line\">$ sudo systemctl restart apache2</span><br><span class=\"line\"><span class=\"comment\"># 切換默認php命令 php7.2,php7.4 ...</span></span><br><span class=\"line\">update-alternatives --<span class=\"built_in\">set</span> php /usr/bin/php7.2</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>",
            "tags": [
                "php",
                "ubuntu",
                "linux"
            ]
        },
        {
            "id": "https://www.sohophp.app/2021/02/07/SELinux/",
            "url": "https://www.sohophp.app/2021/02/07/SELinux/",
            "title": "SELinux",
            "date_published": "2021-02-07T15:02:00.000Z",
            "content_html": "<h3 id=\"SELinux的策略与规则管理相关命令\"><a href=\"#SELinux的策略与规则管理相关命令\" class=\"headerlink\" title=\"SELinux的策略与规则管理相关命令\"></a>SELinux的策略与规则管理相关命令</h3><h4 id=\"getsebool\"><a href=\"#getsebool\" class=\"headerlink\" title=\"getsebool\"></a>getsebool</h4><p>getsebool命令是用来查询SELinux策略内各项规则的布尔值。<br>SELinux的策略与规则管理相关命令：<br>seinfo命令、sesearch命令、getsebool命令、setsebool命令、semanage命令。</p>\n<h5 id=\"选项\"><a href=\"#选项\" class=\"headerlink\" title=\"选项\"></a>选项</h5><p>-a：列出目前系统上面的所有布尔值条款设置为开启或关闭值。</p>\n<h5 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看httpd相关设定</span></span><br><span class=\"line\">$ getsebool -a | grep httpd</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "CentOS",
                "CentOS7",
                "Linux",
                "SELinux"
            ]
        },
        {
            "id": "https://www.sohophp.app/2021/02/02/ModSecurity/",
            "url": "https://www.sohophp.app/2021/02/02/ModSecurity/",
            "title": "ModSecurity",
            "date_published": "2021-02-02T11:52:06.000Z",
            "content_html": "<h2 id=\"安装-ModSecurity\"><a href=\"#安装-ModSecurity\" class=\"headerlink\" title=\"安装 ModSecurity\"></a>安装 ModSecurity</h2><p><a href=\"https://www.modsecurity.org/\">https://www.modsecurity.org/</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装mod_security</span></span><br><span class=\"line\">$ yum install mod_security</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># 重启httpd</span></span><br><span class=\"line\">$ sudo systemctl restart httpd</span><br></pre></td></tr></table></figure>\n<h2 id=\"安装-CRS-CoreRuleSet-规则集\"><a href=\"#安装-CRS-CoreRuleSet-规则集\" class=\"headerlink\" title=\"安装 CRS (CoreRuleSet) 规则集\"></a>安装 CRS (CoreRuleSet) 规则集</h2><p><a href=\"https://coreruleset.org/installation/\">https://coreruleset.org/installation/</a>  </p>\n<a id=\"more\"></a>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 以下以root运行</span></span><br><span class=\"line\">$ su</span><br><span class=\"line\"><span class=\"comment\"># 安装 wget</span></span><br><span class=\"line\">$ sudo yum install wget </span><br><span class=\"line\"><span class=\"comment\"># 进入/etc/httpd下</span></span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> /etc/httpd</span><br><span class=\"line\"><span class=\"comment\"># 下载CRS最新版</span></span><br><span class=\"line\">$ wget https://github.com/coreruleset/coreruleset/archive/v3.3.0.tar.gz</span><br><span class=\"line\"><span class=\"comment\"># 解压缩</span></span><br><span class=\"line\">$ tar -zxvf v3.3.0.tar.gz</span><br><span class=\"line\"><span class=\"comment\"># 创建动态链接</span></span><br><span class=\"line\">$ ln -s coreruleset-3.3.0 /etc/httpd/crs</span><br><span class=\"line\"><span class=\"comment\"># 复制配置文件</span></span><br><span class=\"line\">$ cp crs/crs-setup.conf.example crs/crs-setup.conf</span><br><span class=\"line\"><span class=\"comment\"># 修改conf</span></span><br><span class=\"line\">$ sudo vim /etc/httpd/conf.d/mod_security.conf</span><br><span class=\"line\"><span class=\"comment\"># 加两行</span></span><br><span class=\"line\">&gt; IncludeOptional crs/crs-setup.conf</span><br><span class=\"line\">&gt; IncludeOptional crs/rules/*.conf</span><br><span class=\"line\"><span class=\"comment\"># 检查 httpd配置是否有错</span></span><br><span class=\"line\">$ apachectl configtest</span><br><span class=\"line\"><span class=\"comment\"># 重启 httpd</span></span><br><span class=\"line\">$ systemctl restart httpd</span><br><span class=\"line\"><span class=\"comment\"># 触发警报以进行测试</span></span><br><span class=\"line\">$ curl -I http://localhost?<span class=\"built_in\">exec</span>=/bin/bash</span><br><span class=\"line\">&gt; HTTP/1.1 403 Forbidden</span><br><span class=\"line\"><span class=\"comment\"># 测试 PUT</span></span><br><span class=\"line\">curl -X PUT -I http://localhost</span><br><span class=\"line\">&gt; HTTP/1.1 403 Forbidden</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"开放PUT-DELETE-方法\"><a href=\"#开放PUT-DELETE-方法\" class=\"headerlink\" title=\"开放PUT,DELETE 方法\"></a>开放PUT,DELETE 方法</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /etc/httpd/crs/rules</span><br><span class=\"line\">$ cp REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf</span><br><span class=\"line\"><span class=\"comment\"># 从 REQUEST-901-INITIALIZATION.conf 中复制一段修改加到REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf 下</span></span><br><span class=\"line\"><span class=\"comment\"># id 要修改为唯一，在tx.allowed_methods里加PUT DELETE</span></span><br><span class=\"line\">SecRule &amp;TX:allowed_methods <span class=\"string\">&quot;@eq 0&quot;</span> \\</span><br><span class=\"line\">    <span class=\"string\">&quot;id:9011601,\\</span></span><br><span class=\"line\"><span class=\"string\">    phase:1,\\</span></span><br><span class=\"line\"><span class=\"string\">    pass,\\</span></span><br><span class=\"line\"><span class=\"string\">    nolog,\\</span></span><br><span class=\"line\"><span class=\"string\">    ver:&#x27;OWASP_CRS/3.3.0&#x27;,\\</span></span><br><span class=\"line\"><span class=\"string\">    setvar:&#x27;tx.allowed_methods=GET PUT DELETE HEAD POST OPTIONS&#x27;&quot;</span></span><br><span class=\"line\">$ apachectl configtest</span><br><span class=\"line\">$ systemctl restart httpd</span><br><span class=\"line\">$ curl -X PUT -I http://localhost</span><br><span class=\"line\">&gt; HTTP/1.1 200 OK</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ModSecurity的功能：\"><a href=\"#ModSecurity的功能：\" class=\"headerlink\" title=\"ModSecurity的功能：\"></a>ModSecurity的功能：</h2><ol>\n<li><p>SQL Injection (SQLi)：阻止SQL注入</p>\n<p>程式寫出的漏洞。 編碼 “ 和 ‘ 可以解決</p>\n</li>\n<li><p>Cross Site Scripting (XSS)：阻止跨站脚本攻击</p>\n<p>跨站請求。對程式沒影響，如果有表單使用 CSRF 驗證碼 ，每個表單在打開網址是生成一個用這個網址生成的字串。然後在表單裏用input type=hidden value=驗證碼。 提交後先驗證這個是否正確。</p>\n</li>\n</ol>\n<ol start=\"3\">\n<li><p>Local File Inclusion (LFI)：阻止利用本地文件包含漏洞进行攻击</p>\n<p>程式寫出的漏洞， 在使用include,require,include_once,require_once時注意一下變量不是用戶提交的。 </p>\n</li>\n<li><p>Remote File Inclusione(RFI)：阻止利用远程文件包含漏洞进行攻击</p>\n<p>程式寫出的漏洞，在使用讀文件時。不要執行讀文件內代碼。例如 include,file_get_contets 遠程文件時。</p>\n</li>\n<li><p>Remote Code Execution (RCE)：阻止利用远程命令执行漏洞进行攻击</p>\n<p> 同樣不執行遠程問題，</p>\n</li>\n<li><p>PHP Code Injectiod：阻止PHP代码注入</p>\n<p>主機沒有寫權限就不能執行PHP代碼</p>\n</li>\n<li><p>HTTP Protocol Violations：阻止违反HTTP协议的恶意访问</p>\n<p>使用HTTPS(SSL)</p>\n</li>\n<li><p>HTTPoxy：阻止利用远程代理感染漏洞进行攻击</p>\n<p>主機不使用代理</p>\n</li>\n<li><p>Shellshock：阻止利用Shellshock漏洞进行攻击</p>\n<p> 限制使用以下function:<br> escapeshellarg — 把字符串转码为可以在 shell 命令里使用的参数<br> escapeshellcmd — shell 元字符转义<br> exec — 执行一个外部程序<br> passthru — 执行外部程序并且显示原始输出<br> proc_close — 关闭由 proc_open 打开的进程并且返回进程退出码<br> proc_get_status — 获取由 proc_open 函数打开的进程的信息<br> proc_nice — 修改当前进程的优先级<br> proc_open — 执行一个命令，并且打开用来输入/输出的文件指针。<br> proc_terminate — 杀除由 proc_open 打开的进程<br> shell_exec — 通过 shell 环境执行命令，并且将完整的输出以字符串的方式返回。<br> system — 执行外部程序，并且显示输出</p>\n<p> 如果有程式使用到的要打開，如果apache用戶沒有權限。即使能執行也不能做什麼，現在我們就是這樣。</p>\n</li>\n<li><p>Session Fixation：阻止利用Session会话ID不变的漏洞进行攻击</p>\n<p>curl 帶 cookie，連續執行帶有會話的請求。 首先要得到SessionID,已經得到了后邊隨便執行什麼了。 </p>\n</li>\n<li><p>Scanner Detection：阻止黑客扫描网站</p>\n<p>掃描的主要是網上下載的開源程式。我們沒有。然後是主機端口不關程式。</p>\n</li>\n<li><p>Metadata/Error Leakages：阻止源代码/错误信息泄露</p>\n<p>PHP7 很少。 再有就是程式自己寫出來的錯誤。</p>\n</li>\n<li><p>Project Honey Pot Blacklist：蜜罐项目黑名单<br> 不知道是啥。</p>\n</li>\n<li><p>GeoIP Country Blocking：根据判断IP地址归属地来进行IP阻断</p>\n<p>限IP  ，我很討厭限制IP, 說明自己有漏洞。只限部分人。 沒見過哪個黑客用自己IP的。</p>\n</li>\n</ol>\n",
            "tags": [
                "CentOS",
                "Apache",
                "Linux",
                "ModSecurity",
                "CRS",
                "Httpd"
            ]
        },
        {
            "id": "https://www.sohophp.app/2021/01/31/Linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%A4%87%E7%94%A8/",
            "url": "https://www.sohophp.app/2021/01/31/Linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%A4%87%E7%94%A8/",
            "title": "Linux 常用命令备用",
            "date_published": "2021-01-31T01:14:10.000Z",
            "content_html": "<h2 id=\"netstat\"><a href=\"#netstat\" class=\"headerlink\" title=\"netstat\"></a>netstat</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -nltp</span><br></pre></td></tr></table></figure>\n<p>查看当前监听端口，例如在安装了apache(httpd)和mod_ssl后，测试https不可用。<br>使用netstat -nltp 查看有apache在监听80,但没有443.(重新安装mod_ssl后正常).</p>\n<hr>\n<p><strong><em>持续更新….</em></strong></p>\n",
            "tags": [
                "Linux",
                "Centos"
            ]
        }
    ]
}